# X / Twitter Post API โ Python Client (with Retry & Timeout)

## ๐ ุงููุตู
ูุฐุง ุงูุณูุฑุจุช ููุชูุจ ุจูุบุฉ **Python** ูููุณุชุฎุฏู ูุฅุฑุณุงู ุทูุจ **API** ุฅูู ุณูุฑูุฑ ูุญูู ูุณุคูู ุนู:
- ูุดุฑ ุชุบุฑูุฏุฉ ุนูู ููุตุฉ **X (Twitter)**
- ุงูุงุนุชูุงุฏ ุนูู **ููููุฒ ูุญููุธุฉ ูุณุจููุง** ูุชุณุฌูู ุงูุฌูุณุฉ
- ุฏุนู ูุดุฑ ูุต ููุท ุฃู ูุต + ููุฏูู/ูุณุงุฆุท
- ุงูุชุนุงูู ุงูุฐูู ูุน ุงูุฃุฎุทุงุกุ ุฅุนุงุฏุฉ ุงููุญุงููุฉุ ูุงูููู ุงูุฒูููุฉ

ุงูุณูุฑุจุช ููุงุณุจ ููุงุณุชุฎุฏุงู ูู:
- ุงูุฃุชูุชุฉ (Automation)
- ุงูุจูุชุงุช
- ุฃูุธูุฉ Back-end

---

## ๐งฑ ุงููุชุทูุจุงุช
- Python 3.8 ุฃู ุฃุญุฏุซ
- ุงูููุชุจุงุช ุงูุชุงููุฉ:
  - `requests`
  - `urllib3`

### ุชุซุจูุช ุงููุชุทูุจุงุช
```bash
pip install requests urllib3
```

---

## ๐ ููุฑุฉ ุงูุนูู
1. ุฅูุดุงุก ุฌูุณุฉ `requests.Session`
2. ุชูุนูู **Retry Strategy** ูุฅุนุงุฏุฉ ุงููุญุงููุฉ ุชููุงุฆููุง ุนูุฏ ูุดู ุงูุทูุจ
3. ุฅุฑุณุงู ุทูุจ POST ุฅูู API ูุน:
   - ุฑุงุจุท ููู ุงูููููุฒ
   - ูุต ุงูุชุบุฑูุฏุฉ
   - ุฑุงุจุท ุงููุณุงุฆุท (ุงุฎุชูุงุฑู)
4. ุงูุชุธุงุฑ ุงูุฑุฏ ูุน ูููุฉ ุฒูููุฉ ูุจูุฑุฉ (ููุงุณุจุฉ ููููุฏูููุงุช)
5. ุทุจุงุนุฉ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

---

## ๐ ุงูุญูุงูุฉ
ูุนุชูุฏ ุงูู API ุนูู **Bearer Token** ููุญูุงูุฉ.

```python
headers = {
    "Authorization": "Bearer your-secure-token-here",
    "Content-Type": "application/json"
}
```

> โ๏ธ ูุฌุจ ุฃู ูููู ุงูุชููู ูุทุงุจููุง ููุง ูู ูุฎุตุต ูู ุงูุณูุฑูุฑ.

---

## ๐ ููุฏ ุงูุนููู (Client)

```python
import requests
from requests.adapters import HTTPAdapter
from urllib3.util.retry import Retry
import time

print("โณ ุจุฏุก ุนูููุฉ ุงููุดุฑ...")
start_time = time.time()

session = requests.Session()

retry_strategy = Retry(
    total=3,
    backoff_factor=2,
    status_forcelist=[429, 500, 502, 503, 504],
    allowed_methods=["HEAD", "GET", "POST", "PUT", "DELETE", "OPTIONS", "TRACE"]
)

adapter = HTTPAdapter(max_retries=retry_strategy)
session.mount("http://", adapter)
session.mount("https://", adapter)

headers = {
    "Authorization": "Bearer your-secure-token-here",
    "Content-Type": "application/json"
}

data = {
    "cookies_url": "http://192.168.8.21/up/xx.json",
    "text": "ุชุบุฑูุฏุฉ ุฌุฏูุฏุฉ",
    "media_url": "https://example.com/video.mp4",
    "headless": False
}

try:
    response = session.post(
        "http://localhost:5000/api/post",
        headers=headers,
        json=data,
        timeout=(30, 600)
    )

    response.raise_for_status()
    print(response.json())

finally:
    session.close()
```

---

## ๐งฉ ุดุฑุญ ุงูุญููู ุงููุฑุณูุฉ

| ุงูุญูู | ุงููุตู |
|------|------|
| `cookies_url` | ุฑุงุจุท ููู ุงูููููุฒ ุจุตูุบุฉ JSON |
| `text` | ูุต ุงูุชุบุฑูุฏุฉ |
| `media_url` | ุฑุงุจุท ุงูููุฏูู ุฃู ุงูุตูุฑุฉ (ุงุฎุชูุงุฑู) |
| `headless` | ุชุดุบูู ุงููุชุตูุญ ุจุฏูู ูุงุฌูุฉ |
| `Authorization` | Bearer Token ููุญูุงูุฉ |

---

## โฑ๏ธ ุฅุนุฏุงุฏุงุช ุงููููุฉ (Timeout)

```python
timeout=(30, 600)
```
- `30` ุซุงููุฉ: ูููุฉ ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ
- `600` ุซุงููุฉ (10 ุฏูุงุฆู): ูููุฉ ุงูุชุธุงุฑ ุงูุฑุฏ (ููุงุณุจุฉ ููููุฏูููุงุช ุงููุจูุฑุฉ)

---

## ๐ Retry Strategy

- ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุญุชู **3 ูุฑุงุช**
- ุชุฃุฎูุฑ ุชุตุงุนุฏู:
  - ุงููุญุงููุฉ ุงูุซุงููุฉ ุจุนุฏ 2 ุซุงููุฉ
  - ุงูุซุงูุซุฉ ุจุนุฏ 4 ุซูุงูู
  - ุงูุฑุงุจุนุฉ ุจุนุฏ 8 ุซูุงูู
- ุงูุฃููุงุฏ ุงูุชู ุชูุนุงุฏ ุงููุญุงููุฉ ุนูุฏูุง:
  - `429` (Too Many Requests)
  - `500`, `502`, `503`, `504`

---

## ๐ค ูุซุงู ุงุณุชุฌุงุจุฉ ูุงุฌุญุฉ
```json
{
  "success": true,
  "tweet_id": "1234567890",
  "duration_sec": 58.3
}
```

---

## โ ุฃูุซูุฉ ุฃุฎุทุงุก ูุญุชููุฉ
- ุงูุชูุงุก ูููุฉ ุงูุงูุชุธุงุฑ (Timeout)
- ูุดู ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ
- ุฎุทุฃ ูุตุงุฏูุฉ (401 / 403)
- ุฎุทุฃ ุฏุงุฎูู ูู ุงูุณูุฑูุฑ (500)

ูุชู ุงูุชุนุงูู ูุน ุฌููุน ุงูุญุงูุงุช ุจุฑุณุงุฆู ูุงุถุญุฉ.

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ
- ูุฌุจ ุฃู ูููู ุงูุณูุฑูุฑ ูุนูู ุนูู `localhost:5000`
- ุฑุงุจุท `cookies_url` ูุฌุจ ุฃู ูููู ูุชุงุญูุง ููุณูุฑูุฑ
- ูููุถู ุงุณุชุฎุฏุงู ูุชุบูุฑุงุช ุจูุฆุฉ ููุชููู ูู ุงูุฅูุชุงุฌ
